<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Results</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Weather Details</h1>
    <div id="weather-info"></div>
    <div id="temp-div"></div>
    <img id="weather-icon" alt="Weather Icon">
    <div id="hourly-forecast"></div>

    <!-- JavaScript code here -->
    <script>
        const apiKey = '8a3aafa5bcc20123b98baae6d42fc473'; // Replace with your OpenWeatherMap API key

        // Fetch weather data from OpenWeatherMap API
        async function fetchWeather(city) {
            const currentWeatherUrl = `https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=${apiKey}`;
            const forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${city}&units=metric&appid=${apiKey}`;

            try {
                // Fetch current weather
                const response = await fetch(currentWeatherUrl);
                const data = await response.json();
                if (data.cod === 200) {
                    displayWeather(data);
                } else {
                    alert('City not found!');
                }

                // Fetch forecast data
                const forecastResponse = await fetch(forecastUrl);
                const forecastData = await forecastResponse.json();
                displayHourlyForecast(forecastData.list);
            } catch (error) {
                console.error('Error fetching weather data:', error);
                alert('Error fetching weather data.');
            }
        }

        // Display the current weather details
        function displayWeather(data) {
            const tempDiv = document.getElementById('temp-div');
            const weatherInfoDiv = document.getElementById('weather-info');
            const weatherIcon = document.getElementById('weather-icon');
            const city = data.name;
            const temp = data.main.temp;
            const description = data.weather[0].description;
            const iconCode = data.weather[0].icon;

            tempDiv.textContent = `Temperature: ${temp}°C`;
            weatherInfoDiv.textContent = `Weather: ${description}`;
            weatherIcon.src = `https://openweathermap.org/img/wn/${iconCode}.png`;  // Weather icon from OpenWeatherMap
        }

        // Display hourly forecast
        function displayHourlyForecast(forecast) {
            const hourlyForecastDiv = document.getElementById('hourly-forecast');
            hourlyForecastDiv.innerHTML = ''; // Clear previous forecast

            forecast.forEach(item => {
                const time = new Date(item.dt * 1000).toLocaleTimeString(); // Convert timestamp to time
                const temp = item.main.temp;
                const weather = item.weather[0].description;
                const iconCode = item.weather[0].icon;

                const forecastItem = document.createElement('div');
                forecastItem.className = 'forecast-item';
                forecastItem.innerHTML = `
                    <p>Time: ${time}</p>
                    <p>Temp: ${temp}°C</p>
                    <p>Weather: ${weather}</p>
                    <img src="https://openweathermap.org/img/wn/${iconCode}.png" alt="Weather Icon">
                `;
                hourlyForecastDiv.appendChild(forecastItem);
            });
        }

        // Fetch the city from the URL and load the weather data
        window.addEventListener('load', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const city = urlParams.get('city');
            if (city) {
                fetchWeather(city); // Call fetchWeather with the city from the query string
            }
        });
    </script>
</body>
</html>
